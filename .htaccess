# Generated by Enhanced .htaccess Generator
# Generated on: 2025-07-09 21:22:22 UTC
# Domain: mywebsite.com

# Hide server information
ServerSignature Off
ServerTokens Prod

# ================================
# BASIC APACHE OPTIONS
# ================================
Options -Indexes -MultiViews

# Force UTF-8 encoding
AddDefaultCharset utf-8
AddCharset utf-8 .atom .css .js .json .rss .vtt .xml

# Enable URL rewriting
RewriteEngine On
RewriteBase /

# ================================
# SECURITY CONFIGURATION
# ================================

<IfModule mod_headers.c>
	# Basic security headers
	Header always set X-Content-Type-Options "nosniff"
	Header always set X-Frame-Options "SAMEORIGIN"
	Header always set X-XSS-Protection "1; mode=block"
</IfModule>

# Content Security Policy
<IfModule mod_headers.c>
	Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'strict-dynamic' 'unsafe-inline' 'unsafe-eval' cdn.mywebsite.com assets.mywebsite.com; style-src 'self' 'unsafe-inline' cdn.mywebsite.com assets.mywebsite.com; img-src 'self' data: https: cdn.mywebsite.com assets.mywebsite.com; font-src 'self'; connect-src 'self'; media-src 'self'; object-src 'none'; frame-src 'self'; worker-src 'self'; frame-ancestors 'self'; form-action 'self'; base-uri 'self'; manifest-src 'self'; upgrade-insecure-requests; block-all-mixed-content"
</IfModule>

# Rate limiting protection
<IfModule mod_ratelimit.c>
	SetOutputFilter RATE_LIMIT
	SetEnv rate-limit 15
</IfModule>

# Block bad bots and crawlers
RewriteCond %{HTTP_USER_AGENT} ^.*(robot|spider|crawler|wget|curl|uniform|loader|grab|slurp|Bot|bot|python|harvest|scan|winhttp|clshttp|loader|email|extract|fetch).*$ [NC]
RewriteRule ^ - [F,L]

# ================================
# SSL/HTTPS CONFIGURATION
# ================================

# Force HTTPS redirect
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# HTTP Strict Transport Security (HSTS)
<IfModule mod_headers.c>
	Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
</IfModule>

# ================================
# PERFORMANCE OPTIMIZATIONS
# ================================

# Gzip Compression
<IfModule mod_deflate.c>
	SetOutputFilter DEFLATE
	AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript
	AddOutputFilterByType DEFLATE application/javascript application/x-javascript
	AddOutputFilterByType DEFLATE application/xml application/xml+rss application/xhtml+xml
	AddOutputFilterByType DEFLATE application/rss+xml application/json
	# Don't compress images and other binary files
	SetEnvIfNoCase Request_URI \.(?:gif|jpe?g|png|pdf|zip|rar|exe)$ no-gzip dont-vary
</IfModule>

# Browser Caching
<IfModule mod_expires.c>
	ExpiresActive On
	ExpiresByType text/html "access plus 1 week"
	ExpiresByType text/css "access plus 6 months"
	ExpiresByType application/javascript "access plus 6 months"
	ExpiresByType text/javascript "access plus 6 months"
	ExpiresByType image/jpg "access plus 1 year"
	ExpiresByType image/jpeg "access plus 1 year"
	ExpiresByType image/gif "access plus 1 year"
	ExpiresByType image/png "access plus 1 year"
	ExpiresByType image/webp "access plus 1 year"
	ExpiresByType image/svg+xml "access plus 1 year"
	ExpiresByType application/pdf "access plus 1 month"
	ExpiresByType application/x-shockwave-flash "access plus 1 month"
</IfModule>

# WebP Image Support
<IfModule mod_rewrite.c>
	RewriteCond %{HTTP_ACCEPT} image/webp
	RewriteCond %{REQUEST_FILENAME} \.(jpe?g|png)$
	RewriteCond %{REQUEST_FILENAME}.webp -f
	RewriteRule (.+)\.(jpe?g|png)$ $1.$2.webp [T=image/webp,E=accept:1]
</IfModule>

# ================================
# URL MANAGEMENT
# ================================

# Force Non-WWW
RewriteCond %{HTTP_HOST} ^www\. [NC]
RewriteRule ^(.*)$ https://%{HTTP_HOST:2}/$1 [R=301,L]

# ================================
# FILE PROTECTION
# ================================

# Protect sensitive files
<FilesMatch "^(\.(htaccess|htpasswd|git|env)|wp-config\.php|config\.php|configuration\.php|.*\.log|.*\.ini|.*\.json)$">
	Order allow,deny
	Deny from all
</FilesMatch>

# Block PHP execution in upload directories
<DirectoryMatch "/uploads/">
	php_admin_flag engine off
</DirectoryMatch>

# Block dangerous file uploads
<FilesMatch "\.(php|php3|php4|php5|phtml|phptml|exe|pl|py|jsp|asp|htm|shtml|sh|cgi|dll)$">
	Order Deny,Allow
	Deny from all
</FilesMatch>

# Protect PHP files from direct access
<FilesMatch "\.php$">
	Order Allow,Deny
	Allow from all
	# Deny access to specific PHP files
	<FilesMatch "(config|install|upgrade|admin)\.php$">
		Deny from all
	</FilesMatch>
</FilesMatch>

# Block access to backup and source files
<FilesMatch "(\.(bak|config|sql|fla|psd|ini|log|sh|inc|swp|dist)|~)$">
	Order allow,deny
	Deny from all
	Satisfy All
</FilesMatch>

# Prevent Apache from serving .ht* files
<FilesMatch "^\.ht">
	Order allow,deny
	Deny from all
	Satisfy All
</FilesMatch>

# ================================
# FINAL SECURITY MEASURES
# ================================

# Prevent directory browsing
Options All -Indexes

# Disable server signature
ServerSignature Off

# End of .htaccess file